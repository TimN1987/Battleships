<UserControl x:Class="Battleships.MVVM.View.ShipPlacementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:local="clr-namespace:Battleships.MVVM.View"
             xmlns:enums="clr-namespace:Battleships.MVVM.Enums"
             xmlns:viewmodel="clr-namespace:Battleships.MVVM.ViewModel"
             d:DataContext="{d:DesignInstance Type=viewmodel:ShipPlacementViewModel}"
             mc:Ignorable="d"
             Focusable="True"
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.InputBindings>
        <KeyBinding Key="Up"
                    Command="{Binding MoveFocusCommand}"
                    CommandParameter="{x:Static enums:KeyboardDirection.Up}"/>
        <KeyBinding Key="Down"
                    Command="{Binding MoveFocusCommand}"
                    CommandParameter="{x:Static enums:KeyboardDirection.Down}"/>
        <KeyBinding Key="Left"
                    Command="{Binding MoveFocusCommand}"
                    CommandParameter="{x:Static enums:KeyboardDirection.Left}"/>
        <KeyBinding Key="Right"
                    Command="{Binding MoveFocusCommand}"
                    CommandParameter="{x:Static enums:KeyboardDirection.Right}"/>
        <KeyBinding Key="R"
                    Command="{Binding ChangeShipAlignmentCommand}"/>
        <KeyBinding Key="P"
                    Command="{Binding PlaceShipCommand}"/>
        <KeyBinding Gesture="Ctrl+B"
                    Command="{Binding ChooseShipToPlaceCommand}"
                    CommandParameter="{x:Static enums:ShipType.Battleship}"/>
        <KeyBinding Gesture="Ctrl+C"
                    Command="{Binding ChooseShipToPlaceCommand}"
                    CommandParameter="{x:Static enums:ShipType.Carrier}"/>
        <KeyBinding Gesture="Ctrl+U"
                    Command="{Binding ChooseShipToPlaceCommand}"
                    CommandParameter="{x:Static enums:ShipType.Cruiser}"/>
        <KeyBinding Gesture="Ctrl+D"
                    Command="{Binding ChooseShipToPlaceCommand}"
                    CommandParameter="{x:Static enums:ShipType.Destroyer}"/>
        <KeyBinding Gesture="Ctrl+M"
                    Command="{Binding ChooseShipToPlaceCommand}"
                    CommandParameter="{x:Static enums:ShipType.Submarine}"/>
    </UserControl.InputBindings>
    <Grid>
        <Viewbox Stretch="Uniform">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="80"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="400"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="70"/>
                    <RowDefinition Height="40"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="30"/>
                    <ColumnDefinition Width="400"/>
                    <ColumnDefinition Width="30"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Viewbox Grid.Row="1" 
                 Grid.Column="2" Grid.ColumnSpan="3">
                    <TextBlock Text="Place your ships"
                       Style="{DynamicResource TitleText}"/>
                </Viewbox>
                <Grid Grid.Row="3"
                      Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="20"/>
                        <RowDefinition Height="100"/>
                        <RowDefinition Height="20"/>
                        <RowDefinition Height="100"/>
                        <RowDefinition Height="20"/>
                        <RowDefinition Height="100"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Button Grid.Row="1"
                            Style="{DynamicResource PictureButtonStyle}"
                            Command="{Binding ChooseShipToPlaceCommand}"
                            CommandParameter="{x:Static enums:ShipType.Battleship}"
                            ToolTip="{Binding BattleshipTooltip}"
                            Click="Button_Click">
                        <Image Source="{Binding BattleshipButtonImage}"/>
                    </Button>
                    <Button Grid.Row="3"
                    Content="Carrier"
                    Command="{Binding ChooseShipToPlaceCommand}"
                    CommandParameter="{x:Static enums:ShipType.Carrier}"
                    Click="Button_Click"
                    ToolTip="{Binding CarrierTooltip}"/>
                    <Button Grid.Row="5"
                    Content="Crusier"
                    Command="{Binding ChooseShipToPlaceCommand}"
                    CommandParameter="{x:Static enums:ShipType.Cruiser}"
                    Click="Button_Click"
                    ToolTip="{Binding CruiserTooltip}"/>
                </Grid>
                <ItemsControl Grid.Row="3" Grid.Column="3"
                      ItemsSource="{Binding GridCells}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <UniformGrid Rows="10" Columns="10"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Style="{DynamicResource ShipDisplayGridButton}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="MouseEnter">
                                        <i:InvokeCommandAction Command="{Binding DataContext.MouseEnterCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                       CommandParameter="{Binding Index}"/>
                                    </i:EventTrigger>
                                    <i:EventTrigger EventName="MouseMove">
                                        <i:InvokeCommandAction Command="{Binding DataContext.MouseMoveCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                       CommandParameter="{Binding Index}"/>
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                <Grid Grid.Row="3"
              Grid.Column="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="20"/>
                        <RowDefinition Height="100"/>
                        <RowDefinition Height="20"/>
                        <RowDefinition Height="100"/>
                        <RowDefinition Height="20"/>
                        <RowDefinition Height="100"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Button Grid.Row="1"
                    Content="Destroyer"
                    Command="{Binding ChooseShipToPlaceCommand}"
                    CommandParameter="{x:Static enums:ShipType.Destroyer}"
                    Click="Button_Click"
                    ToolTip="{Binding DestroyerTooltip}"/>
                    <Button Grid.Row="3"
                    Content="Submarine"
                    Command="{Binding ChooseShipToPlaceCommand}"
                    CommandParameter="{x:Static enums:ShipType.Submarine}"
                    Click="Button_Click"
                    ToolTip="{Binding SubmarineTooltip}"/>
                    <Button Grid.Row="5"
                    Command="{Binding ChangeShipAlignmentCommand}"
                    Click="Button_Click"
                    Style="{DynamicResource PictureButtonStyle}">
                        <Image Source="{Binding RotationButtonImage}"/>
                    </Button>
                </Grid>
                <Grid Grid.Row="5"
              Grid.Column="3">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="3*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>
                    <Button Grid.Column="0"
                    Content="Randomize"
                    Command="{Binding SetRandomShipPlacementsCommand}"
                    Click="Button_Click"
                    Style="{DynamicResource StandardButtonStyle}"/>
                    <Button Grid.Column="2"
                    Content="Continue"
                    Command="{Binding StartGameCommand}"
                    Click="Button_Click"
                    Style="{DynamicResource StandardButtonStyle}"/>
                </Grid>
            </Grid>
        </Viewbox>
    </Grid>
</UserControl>
